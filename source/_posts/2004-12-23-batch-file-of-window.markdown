---
layout: post
title: "用Windows下的批次檔(.bat)加上排定的工作，打造自己的備份系統"
date: 2004-12-23 09:39
comments: true
tags: Windows
---
相信大家都有三不五時，備份某個資料夾的經驗吧，每次固定到了某個時間，就必須備份自己的資料， 
這些工作雖然不難，但是很繁瑣，而且有時候會忘記，而且出事情的時候往往是你忘記備份的那個時候， 
我們希望電腦可以在每隔幾天的時候，就幫妳把特定的某個資料夾做備份，最好還是可以壓縮起來，然後檔名按照當天日期命名，如abc-2006-01-01，abc-2006-02-01的檔名，
這裡Eric教大家一個簡單的方式，就是用Windows下的批次檔(.bat)加上排定的工作，打造自己的備份系統，

<!--more-->

首先妳必須要有個可以在命令列下壓縮指令的程式，在這邊推薦7z，7z壓縮比例是所有壓縮程式最高的，而且又支援unicode，也就是說不管什麼日本字，簡體字。他通通會認得，大家可以到
[7-z](http://www.7-zip.org/download.html)， 下載7-Zip Command Line Version的版本

抓回來後，就可以開始撰寫批次檔，首先介紹7z的命令要怎麼下
	7za a -tzip 目的檔名 來源檔名

而其中 `7za a -tzip` 是代表叫7z把該目錄壓縮成zip格式，當然為了支援 unicode，妳也可以換成-t7z， 而如果妳要讓妳的檔名含有日期的話，妳可以參考下面
	E:\Backup\MyDoc-%date:~0，4%-%date:~5，2%-%date:~8，2%.zip

這個例子表示你備份的檔案，要存到E槽的backup目錄下面，而檔名會是abc-2006-11-18.zip， 

而這邊為要讓妳的檔名可以加入當天的壓縮日期，這邊用了個小技巧，
在Dos下面提供了一些取當天日期的變數%date%，
妳可以在Dos下打echo %date%，就可以看的到今天的日期，而這個日期等下會變成你的檔名，
而%date:~0，4，就是代表取%date這個參數的第0個字到第4個字，在這邊就是西元年份嚕，像今年他就會取出2006出來，

而完整的命令如下
	7za a -tzip E:\Backup\MyDoc-%date:~0，4%-%date:~5，2%-%date:~8，2%.zip "C:\MyDoc"

首先先打開記事本，按照上面的命令打入，然後存檔存成*.bat就完成了批次檔的撰寫

接下來就進到開始/程式集/附屬應用程式/系統工具/排定的工作，新增一個排定的工作， 先按下一步，到選擇應用程式的對話匡，這時候可以按下瀏覽，
找到我們剛剛撰寫好的批次檔，點下去，接下來設定每次跑的時間就可以了  

是不是很簡單阿？